(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const h of r.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}})();const m1=Symbol(),r1=function(e){try{return e(...[].slice.call(arguments,1))}catch(t){return setTimeout(()=>{throw t}),t instanceof Error?t:t=new Error(t)}};function J(e,t){if(e)throw new Error(`Reatom error: ${t}`)}const t1=e=>(e==null?void 0:e.__reatom)!==void 0,B=e=>e.subs.size+e.listeners.size>0;function i1(e){J(typeof e!="function",`invalid "${typeof e}", function expected`)}const b1=e=>e.cause===null?e:b1(e.cause),N1=()=>{var e;return!!((e=globalThis.navigator)!=null&&e.userAgent)};let O,j1=0;const T1=({callLateEffect:e=r1,callNearEffect:t=r1,restrictMultipleContexts:n=N1()}={})=>{n&&j1++==1&&console.warn("Reatom: multiple contexts detected, which is irrelevant in browser, you should use only one context");let o=new WeakMap,r=f=>o.get(f),h=new Set,w=[],l=[],a=!1,g=null,m=[],k=[],c=[],x=0,L=0,b=!1,_=()=>{for(let f of w)t(f,q);w=[]},E=()=>{if(!b){b=!0,_();for(let f of l)e(f,q),w.length>0&&_();l=[],b=!1}},I=({state:f,proto:i,pubs:y,subs:s,listeners:u},A)=>(i.actual=!1,c.push(i.patch={state:f,proto:i,cause:A,pubs:y,subs:s,listeners:u}),i.patch),v=f=>{var i;for(let y of f.subs){let s=(i=y.patch)!=null?i:r(y);y.patch&&!y.actual||I(s,f).listeners.size===0&&v(s)}},G=(f,i)=>{if(i.subs.delete(f)&&(k.push(()=>i.subs.add(f)),!B(i))){i.proto.disconnectHooks!==null&&w.push(...i.proto.disconnectHooks);for(let y of i.pubs)G(i.proto,y)}},U=(f,i)=>{if(!i.subs.has(f)){let y=B(i);if(i.subs.add(f),k.push(()=>i.subs.delete(f)),!y){i.proto.connectHooks!==null&&w.push(...i.proto.connectHooks);for(let s of i.pubs)U(i.proto,s)}}},W=(f,i,y)=>{let{patch:s,actual:u}=i,A=y!==void 0;if(!A&&u&&(s.pubs.length===0||B(s)))return s;let C=s!=null?s:r(i),M=!C,s1=A?f.cause:r(n1);if(M)C={state:i.initState(f),proto:i,cause:s1,pubs:[],subs:new Set,listeners:new Set};else if(i.computer===null&&!A)return C;s&&!u||(s=I(C,s1));let{state:k1}=s,V={get:f.get,spy:void 0,schedule:f.schedule,subscribe:f.subscribe,cause:s};try{i.computer&&((Y,H)=>{var f1,p1;let{proto:d1,pubs:F}=H,h1=!1;if(F.length===0||F.some(({proto:P,state:N})=>!Object.is(N,(H.cause=W(Y,P)).state))){let P=[];if(Y.spy=({__reatom:N},$)=>{if(H.pubs===F){let Z=W(Y,N),X=P.push(Z)<=F.length?F[P.length-1]:void 0,D=(X==null?void 0:X.proto)!==Z.proto;h1||(h1=D);let e1=N.isAction&&!D?Z.state.slice(X.state.length):Z.state;if(!$||!D&&Object.is(e1,X.state))return e1;if(N.isAction)for(const C1 of e1)$(C1);else $(e1,D||X==null?void 0:X.state)}else J(!0,"async spy")},H.state=H.proto.computer(Y,H.state),H.pubs=P,(h1||F.length>P.length)&&B(H)){for(let{proto:N}of F)P.every($=>$.proto!==N)&&G(d1,(f1=N.patch)!=null?f1:r(N));for(let{proto:N}of P)F.every($=>$.proto!==N)&&U(d1,(p1=N.patch)!=null?p1:r(N))}}})(V,s),A&&(s.cause=f.cause,y(V,s)),i.actual=!0}catch(Y){throw s.error=Y}if(!Object.is(k1,s.state)&&(s.subs.size>0&&(A||s.listeners.size>0)&&v(s),i.updateHooks)){let Y={get:V.get,spy:void 0,schedule:V.schedule,subscribe:V.subscribe,cause:V.cause};i.updateHooks.forEach(H=>m.push(()=>H(Y,s)))}return s},q={get(f){if(J(O&&b1(O.cause)!==r(n1),"cause collision"),t1(f)){let s=f.__reatom;if(a)return W(this,s).state;let u=r(s);return u===void 0||s.computer!==null&&!B(u)?this.get(()=>W(this,s).state):u.state}if(J(g!==null,"tr failed"),a)return f(r,W);a=!0,x=w.length,L=l.length;let i=O===void 0;i&&(O=this);try{var y=f(r,W);for(let s=0;s<c.length;s++){let{listeners:u,proto:A}=c[s];if(u.size>0&&W(this,A),m.length>0)for(let C of m.splice(0))C(this)}if(c.length)for(let s of h)s(c);for(let s of c){let{proto:u,state:A}=s;if(u.isAction&&(s.state=[]),s===u.patch)if(u.patch=null,u.actual=!1,o.set(u,s),u.isAction){if(A.length===0)continue;for(let C of s.listeners)w.push(()=>C(A))}else for(let C of s.listeners)l.push(()=>C(r(u).state))}}catch(s){g=s=s instanceof Error?s:new Error(String(s));for(let u of h)u(c,s);for(let u of k)r1(u,s);for(let{proto:u}of c)u.patch=null,u.actual=!1;throw w.length=x,l.length=L,s}finally{a=!1,g=null,m=[],k=[],c=[],x=0,L=0,i&&(O=void 0)}return E(),y},spy:void 0,schedule(f,i=1){return i1(f),J(!this,"missed context"),new Promise((y,s)=>{i===-1?a&&k.push(f):i===0?a&&m.push(()=>f(this)):((i===1?w:l).push(()=>{try{let u=f(this);return u instanceof Promise?u.then(y,s):y(u),u}catch(u){throw s(u),u}}),a||E())})},subscribe(f,i=f){var C;if(i1(i),f===i)return h.add(i),()=>h.delete(i);let{__reatom:y}=f,s=m1,u=M=>Object.is(s,M)||i(s=M),A=r(y);return A!==void 0&&B(A)?A.listeners.add(u):this.get(()=>{A=W(this,y,(M,s1)=>{}),A.listeners.add(u),k.push(()=>y.patch.listeners.delete(u)),y.connectHooks!==null&&w.push(...y.connectHooks);for(let M of A.pubs)U(y,M)}),s===m1&&u(((C=y.patch)!=null?C:r(y)).state),()=>{if(A.listeners.delete(u)&&!B(A)){y.disconnectHooks&&w.push(...y.disconnectHooks);for(let M of A.pubs)G(y,M);a||(k.length=0,E())}}},cause:void 0};return(q.cause=q.get(()=>W(q,n1))).cause=null,q};let z1=0,v1=e=>`${e}#${++z1}`;function H1(){return[].slice.call(arguments).reduce((e,t)=>t(e),this)}function I1(e){var n,o;const t=(r,h)=>e(r,h.state);return((o=(n=this.__reatom).updateHooks)!=null?o:n.updateHooks=new Set).add(t),()=>this.__reatom.updateHooks.delete(t)}function W1(e){return this.onChange((t,n)=>{const{params:o,payload:r}=n[n.length-1];e(t,r,o)})}function T(e,t=v1("_atom")){let n=(r,h)=>r.get((w,l)=>l(r,n.__reatom,(a,g)=>{g.state=typeof h=="function"?h(g.state,a):h}).state),o=null;return typeof e=="function"&&(n={},o=e,e=void 0),n.__reatom={name:t,isAction:!1,patch:null,initState:()=>e,computer:o,connectHooks:null,disconnectHooks:null,updateHooks:null,actual:!1},n.pipe=H1,n.onChange=I1,g1.length===0?n:n.pipe(...g1)}const M1=(e,t)=>{e!==void 0&&typeof e!="string"||(t=e,e=(o,r)=>r),i1(e);let n=T([],t!=null?t:v1("_action"));return n.__reatom.isAction=!0,n.__reatom.unstable_fn=e,Object.assign(function(){var o=[].slice.call(arguments);let r=n(o[0],(h,w)=>(o[0]=w,[...h,{params:o.slice(1),payload:w.cause.proto.unstable_fn(...o)}]));return r[r.length-1].payload},n,{onCall:W1})},g1=[],n1=T(void 0,"root").__reatom,R1=e=>typeof e=="object"&&e!==null,Y1=(e=0,t=Number.MAX_SAFE_INTEGER-1)=>Math.floor(Math.random()*(t-e+1))+e,F1=e=>e instanceof Error&&e.name==="AbortError",P1=Symbol("Reatom linked list next"),X1=e=>(e==null?void 0:e.__reatomLinkedList)===!0,w1=e=>typeof e=="boolean"||e===""||e==null;let Q=new WeakMap,o1=(e,t)=>{Promise.resolve().then(()=>{var n;if(e.isConnected)for(;e.parentElement&&!((n=Q.get(e))!=null&&n.push(()=>e.isConnected||t()));)e=e.parentElement;else t()})};const $1=(e,t=globalThis.window)=>{let n,o={},r="",h=(l,a,g)=>{if(a.startsWith("on:"))a=a.slice(3),g=M1(g,`${r}.${l.nodeName.toLowerCase()}._${a}`),l.addEventListener(a,m=>g(e,m));else if(a.startsWith("css:"))a="--"+a.slice(4),g==null?l.style.removeProperty(a):l.style.setProperty(a,String(g));else if(a==="css"){n!=null||(n=t.document.getElementById("reatom-jsx-styles")),n||(n=t.document.createElement("style"),n.id="reatom-jsx-styles",t.document.head.appendChild(n));let m=o[g];m||(m=o[g]="reatom-"+Y1(),n.innerText+="."+m+"{"+g+`}
`),l.classList.add(m)}else if(a==="style"&&typeof g=="object")for(const m in g)g[m]==null?l.style.removeProperty(m):l.style.setProperty(m,g[m]);else a.startsWith("prop:")?l[a.slice(5)]=g:(a.startsWith("attr:")&&(a=a.slice(5)),g==null?l.removeAttribute(a):l.setAttribute(a,String(g)))},w=()=>{};return{h:function(l,a){var g=[].slice.call(arguments,2);if(l===w)return g;if(typeof l=="function"){(a!=null?a:a={}).children=g;let c=l.name;try{return r=l.name,l(a)}finally{r=c}}let m=l.startsWith("svg:")?t.document.createElementNS("http://www.w3.org/2000/svg",l.slice(4)):t.document.createElement(l);for(let c in a){let x=a[c];if(t1(x)&&!x.__reatom.isAction){if(c.startsWith("model:")){let b=c=c.slice(6);h(m,"on:input",(_,E)=>{x(_,b==="valueAsNumber"?+E.target.value:E.target[b])}),c==="valueAsNumber"&&(c="value"),c="prop:"+c}let L;L=e.subscribe(x,b=>!L||m.isConnected?c==="$spread"?Object.entries(b).forEach(([_,E])=>h(m,_,E)):h(m,c,b):L()),o1(m,L)}else h(m,c,x)}let k=c=>{if(Array.isArray(c))for(let L=0;L<c.length;L++)k(c[L]);else if(X1(c))((L,b,_)=>{let E=-1;o1(b,L.subscribe(_,I=>{if(I.version-1>E){b.innerHTML="";for(let{head:v}=I;v;v=v[P1])b.append(v)}else for(const v of I.changes){if(v.kind==="create"&&b.append(v.node),v.kind==="remove"&&b.removeChild(v.node),v.kind==="swap"){let[G,U]=[v.a.nextSibling,v.b.nextSibling];U?b.insertBefore(v.a,U):b.append(v.a),G?b.insertBefore(v.b,G):b.append(v.b)}v.kind==="move"&&(v.after?v.after.insertAdjacentElement("afterend",v.node):b.append(v.node)),v.kind==="clear"&&(b.innerHTML="")}E=I.version}))})(e,m,c);else if(t1(c)){let L,b=t.document.createTextNode("");var x=e.subscribe(c,_=>{try{if(x&&!b.isConnected&&b instanceof t.DocumentFragment==0)x();else if(J(Array.isArray(_)&&g.length>1,"array children with other children are not supported"),_ instanceof t.Element){let E=Q.get(_);E||Q.set(_,E=[]),x&&m.replaceChild(_,b),b=_}else if(Array.isArray(_))if(x)m.replaceChildren(..._);else{const E=new t.DocumentFragment;_.forEach(I=>E.append(I)),b=E}else b.textContent=w1(_)?"":String(_)}catch(E){L=E}});if(L)throw L;o1(m,x),m.appendChild(b)}else w1(c)||m.appendChild(R1(c)&&"nodeType"in c?c:t.document.createTextNode(String(c)))};return g.forEach(k),m},hf:w,mount:(l,a)=>{l.append(...[a].flat(1/0)),new t.MutationObserver(g=>{for(let m of g)for(let k of m.removedNodes){let c=Q.get(k);c&&(c.forEach(x=>x()),Q.delete(k))}}).observe(l,{childList:!0,subtree:!0})}}},z=T1(),{h:p,hf:re,mount:B1}=$1(z);let K1={view:{radius:1}};const G1=e=>{var t,n;return(n=(t=e[0])==null?void 0:t.map((o,r)=>e.map(h=>h[r])))!=null?n:[]},R={finish:-1,land:0,spike:-2,torch:100,wall:1},d=[[[1,1,1,1,1,1,1],[1,0,0,0,0,-1,1],[1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,1,1,1,1,0,1],[1,0,0,0,0,0,1],[1,0,1,1,1,1,1],[1,0,0,0,0,-1,1],[1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1],[1,0,0,0,0,1,-1,1],[1,1,1,1,0,1,0,1],[1,0,0,0,0,1,0,1],[1,0,1,1,1,1,0,1],[1,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1],[1,0,-2,0,0,0,-2,-1,1],[1,0,0,0,-2,0,0,0,1],[1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,1,1,0,100,0,1],[1,-1,1,0,0,0,1],[1,0,1,1,1,0,1],[1,0,0,0,0,0,1],[1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1],[1,0,1,0,0,0,1,0,1],[1,0,0,0,-2,0,0,0,1],[1,0,1,-2,-1,-2,1,0,1],[1,0,1,1,0,1,1,0,1],[1,0,1,1,0,1,1,0,1],[1,0,1,-2,0,-2,1,0,1],[1,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1],[1,0,0,0,-2,0,0,0,1],[1,0,-2,0,0,0,-2,0,1],[1,0,0,-2,-2,-2,0,0,1],[1,-2,0,-2,0,-2,0,-2,1],[1,0,0,-2,-2,-2,0,0,1],[1,0,-2,0,0,0,-2,0,1],[1,0,0,0,-2,0,0,-1,1],[1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1,1],[1,0,0,1,0,0,0,0,0,1],[1,0,1,1,0,1,1,1,0,1],[1,0,0,0,0,0,0,1,0,1],[1,0,1,1,1,1,1,1,0,1],[1,0,0,0,0,0,0,1,0,1],[1,1,1,1,1,1,0,1,0,1],[1,0,0,0,0,1,0,1,0,1],[1,0,1,1,1,1,0,1,0,1],[1,0,0,0,0,0,0,1,-1,1],[1,1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,1,0,0,0,0,0,1],[1,0,1,0,1,0,1,1,1,0,1],[1,1,1,0,1,0,1,-1,1,0,1],[1,0,0,0,1,0,1,0,0,0,1],[1,0,1,0,1,0,1,1,1,1,1],[1,0,1,0,1,0,0,0,0,0,1],[1,0,1,1,1,0,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,1,0,0,0,1,-1,1],[1,0,1,0,1,0,1,1,1,0,1],[1,0,1,0,1,0,0,0,1,0,1],[1,0,1,1,1,0,1,0,1,0,1],[1,0,1,0,0,0,1,0,1,0,1],[1,0,1,0,1,1,1,0,1,0,1],[1,0,0,0,0,0,1,0,0,0,1],[1,0,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,1,0,0,0,1],[1,0,1,1,1,1,1,0,1,0,1],[1,0,0,0,1,0,0,0,1,0,1],[1,1,1,0,1,0,1,1,1,0,1],[1,-1,1,0,0,0,1,0,0,0,1],[1,0,1,1,1,1,1,0,1,0,1],[1,0,0,0,1,0,0,0,1,0,1],[1,1,1,0,1,0,1,1,1,0,1],[1,0,0,0,0,0,0,0,1,0,1],[1,1,1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,1,0,0,0,1,0,1,0,0,0,0,0,1],[1,0,1,0,1,0,0,0,1,0,1,1,1,0,1],[1,0,0,0,1,0,1,0,1,0,0,-1,1,0,1],[1,0,1,1,1,0,1,0,1,0,1,1,1,0,1],[1,0,0,0,0,0,1,0,1,0,1,0,0,0,1],[1,0,1,1,1,1,1,0,1,0,1,0,1,0,1],[1,0,0,0,0,0,1,0,0,0,1,0,1,0,1],[1,1,1,1,1,0,1,1,1,0,1,0,1,1,1],[1,0,0,0,1,0,0,0,1,0,1,0,0,0,1],[1,0,1,1,1,1,1,0,1,0,1,1,1,0,1],[1,0,0,0,0,0,1,0,1,0,1,0,0,0,1],[1,0,1,1,1,0,1,0,1,1,1,0,1,0,1],[1,0,0,0,1,0,0,0,0,0,0,0,1,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,1,0,0,0,0,0,0,0,0,0,1,0,1],[1,0,1,0,1,1,1,0,1,1,1,0,1,0,1],[1,0,1,0,0,0,1,0,0,0,1,0,1,0,1],[1,0,1,1,1,1,1,1,1,0,1,0,1,0,1],[1,0,0,0,1,0,0,0,0,0,1,0,0,0,1],[1,1,1,0,1,0,1,1,1,0,1,1,1,0,1],[1,0,1,0,0,0,1,0,1,0,0,0,0,0,1],[1,0,1,1,1,1,1,0,1,0,1,0,1,1,1],[1,0,0,0,1,0,0,0,0,0,1,0,0,0,1],[1,0,1,0,1,0,1,1,1,1,1,1,1,0,1],[1,0,1,-1,1,0,1,0,0,0,0,0,0,0,1],[1,0,1,1,1,0,1,0,1,1,1,1,1,0,1],[1,0,0,0,0,0,0,0,1,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,1,0,0,0,0,0,1,0,0,0,1],[1,1,1,0,1,0,1,0,1,1,1,0,1,0,1],[1,0,0,0,1,-1,1,0,0,0,0,0,1,0,1],[1,0,1,1,1,1,1,1,1,0,1,1,1,0,1],[1,0,0,0,0,0,0,0,1,0,0,0,1,0,1],[1,1,1,1,1,0,1,1,1,1,1,1,1,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,1,1,1,1,1,1,1,0,1,0,1,1,1],[1,0,1,0,0,0,0,0,1,0,1,0,0,0,1],[1,0,1,0,1,0,1,1,1,0,1,0,1,0,1],[1,0,0,0,1,0,0,0,0,0,1,0,1,0,1],[1,0,1,1,1,1,1,1,1,1,1,1,1,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,1],[1,1,1,1,1,0,1,0,1,1,1,0,1,1,1,0,1,0,1,0,1],[1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1],[1,1,1,0,0,0,1,1,1,1,1,1,1,0,1,1,1,1,1,0,1],[1,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,1],[1,0,1,1,1,1,1,1,1,0,1,0,1,1,1,0,1,0,1,1,1],[1,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,1,0,0,0,1],[1,0,1,1,1,1,1,1,1,1,1,0,1,0,1,0,1,1,1,0,1],[1,0,0,0,1,0,0,0,0,0,0,0,1,0,1,0,0,0,1,0,1],[1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,1,0,1,0,1],[1,0,0,0,1,0,0,0,1,0,1,0,0,0,0,0,1,0,1,0,1],[1,0,1,1,1,0,1,0,1,0,1,0,1,1,1,0,1,0,1,0,1],[1,0,1,0,0,0,1,0,1,0,0,0,0,-1,1,0,1,0,0,0,1],[1,0,1,1,1,0,1,0,1,1,1,1,1,1,1,0,1,0,1,1,1],[1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,1],[1,0,1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,0,1],[1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,1],[1,0,1,1,1,0,1,0,1,0,1,1,1,1,1,1,1,1,1,0,1],[1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]],S=e=>({matrix:G1(e),array:e.flat()}),U1=[{width:d[0][0].length,height:d[0].length,map:S(d[0]),start:[1,1]},{width:d[1][0].length,height:d[1].length,map:S(d[1]),start:[1,1]},{width:d[2][0].length,height:d[2].length,map:S(d[2]),start:[1,1]},{width:d[3][0].length,height:d[3].length,map:S(d[3]),start:[1,1]},{width:7,height:7,map:S(d[4]),start:[1,1]},{width:9,height:9,map:S(d[5]),start:[4,1]},{width:9,height:9,map:S(d[6]),start:[1,1]},{width:d[7][0].length,height:d[7].length,map:S(d[7]),start:[2,1]},{width:d[8][0].length,height:d[8].length,map:S(d[8]),start:[1,2]},{width:d[9][0].length,height:d[9].length,map:S(d[9]),start:[1,9]},{width:d[10][0].length,height:d[10].length,map:S(d[10]),start:[5,1]},{width:d[11][0].length,height:d[11].length,map:S(d[11]),start:[3,9]},{width:d[12][0].length,height:d[12].length,map:S(d[12]),start:[5,3]},{width:d[13][0].length,height:d[13].length,map:S(d[13]),start:[7,13]},{width:d[14][0].length,height:d[14].length,map:S(d[14]),start:[9,1]}],A1=(e,t)=>{const[n,o]=e;return n>=0&&o>=0&&n<t.width&&o<t.height},q1=(e,t)=>{if(A1(e,t))return e[0]+e[1]*t.width},j=(e,t)=>t1(t)?e.cause.proto.isAction||e.spy===void 0?e.get(t):e.spy(t):typeof t=="function"?t(e):t,y1=(e,t,n=1)=>{const o=Math.abs(n)*(e>t?-1:1);return Array.from({length:Math.ceil(Math.abs((t-e)/(o||1)))},(r,h)=>e+h*o)};let _1=0;const K=T(a1()),E1=T(["lighter"]),c1=T("start-screen"),V1={ArrowUp:[0,-1],ArrowDown:[0,1],ArrowLeft:[-1,0],ArrowRight:[1,0],KeyW:[0,-1],KeyS:[0,1],KeyA:[-1,0],KeyD:[1,0]};let L1=0,x1=0;const S1=e=>{const t=V1[e];if(!t)return;let[n,o]=t,[r,h]=j(z,l1),w=j(z,K);r+=n,h+=o;const l=w.map.matrix[r][h];if(A1([r,h],w)&&l!==R.wall){if(l===R.finish){_1+=1;try{K(z,a1())}catch(a){c1(z,"final-screen");return}alert("You Win!"),w=j(z,K),r=+w.start[0],h=+w.start[1]}if(l===R.spike&&(alert("You're dead, start from the beginning"),K(z,a1()),r=+w.start[0],h=+w.start[1]),l===R.torch){alert("You picked up the torch. The light has lit up the room, now you see more");const a=structuredClone(w);a.map.matrix[r][h]=0,K(z,a),E1(z,g=>[...g,"torch"])}l1(z,[r,h])}};window.document.addEventListener("keydown",e=>{S1(e.code)});window.addEventListener("touchstart",e=>{e.preventDefault(),L1=e.touches[0].clientX,x1=e.touches[0].clientY});window.addEventListener("touchend",e=>{e.preventDefault();const t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY,o=t-L1,r=n-x1;let h;Math.abs(o)>Math.abs(r)?h=o<0?"ArrowRight":"ArrowLeft":h=r<0?"ArrowDown":"ArrowUp",S1(h)});function a1(){const e=U1[_1];if(e===void 0)throw new Error("Level Not Found");return e}const l1=T([...j(z,K).start]),u1=T(e=>{const t=j(e,E1);let n=K1.view.radius;return t.includes("torch")&&(n+=1),n}),J1=T(e=>j(e,u1)*2+1),O1=T(e=>{const t=j(e,u1),[n,o]=j(e,l1),r=j(e,K);return y1(o-t,o+t+1).map(w=>y1(n-t,n+t+1).map(l=>{const a=q1([l,w],r);return{x:w,y:l,index:a,item:a===void 0?void 0:r.map.matrix[l][w]}})).flat()}),Q1=T(e=>{switch(j(e,c1)){case"start-screen":return p(D1,null);case"game-screen":return p(ee,null);case"final-screen":return p(te,null)}}),Z1=()=>(document.title="Mafia Dungeons Game by rail-rz",p("div",{css:`
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
      `},Q1)),D1=()=>p("img",{src:"/mafia-dungeons/assets/start.png",css:`
        width: 100%;
        image-rendering: pixelated;
        position: absolute;
        z-index: 100;
      `,"on:click":(e,t)=>c1(e,"game-screen")}),ee=()=>p("div",{css:`
        position: relative;
        display: grid;
        gap: 5px;
        grid-template-columns: repeat(var(--diameter), 1fr);
        grid-template-rows: repeat(var(--diameter), 1fr);
      `,"css:diameter":J1},p("div",{class:"template"},T(e=>j(e,O1).map(o=>se(o.item)))),p("div",{class:"tile player",css:`
          grid-area: var(--radius) / var(--radius);
          position: absolute;
        `,"css:radius":T(e=>j(e,u1)+1)})),te=()=>p("div",{css:`
      align-items: center;
      justify-content: center;
    `},p("h1",null,"You've completed the demo!"),p("h2",null,"Enjoyed it?"),p("h3",null,"You can support the project in any of the following ways: donate, follow us on social media, or explore our animations."),p("div",{css:`
          position: relative;
          display: grid;
          grid-template-columns:repeat(auto-fill, minmax(256px, 256px));
          gap: 5px;
          place-items: center;

        `},p("div",{css:"width: 128px;"},p("a",{target:"_blank",href:"https://lospec.com/rail-rz"},p("img",{src:"/mafia-dungeons/assets/misfire.gif",css:"width: 128px; image-rendering: pixelated;"})),p("div",null,p("a",{target:"_blank",href:"https://lospec.com/rail-rz"},"project's animation"))),p("div",{css:"width: 128px;"},p("a",{href:"mailto: zamaletdinov.rz@gmail.com"},p("img",{src:"/mafia-dungeons/assets/mail.gif",css:"width: 128px; image-rendering: pixelated;"})),p("div",null,p("a",{target:"_blank",href:"mailto: zamaletdinov.rz@gmail.com"},"Write Me"))),p("div",{css:"width: 128px;"},p("a",{target:"_blank",href:"https://paypal.me/railrz"},p("img",{src:"/mafia-dungeons/assets/tipjar.gif",css:"width: 128px; image-rendering: pixelated;"})),p("div",null,p("a",{target:"_blank",href:"https://paypal.me/railrz"},"Paypal"))))),se=e=>{switch(e){case R.finish:return p("div",{class:"tile finish"});case R.land:return p("div",{class:"tile land"});case R.spike:return p("div",{class:"tile land spike"});case R.torch:return p("div",{class:"tile land torch"});case R.wall:return p("div",{class:"tile wall"});default:return p("div",{class:"tile unknown"})}};window.addEventListener("unhandledrejection",e=>{F1(e.reason)&&e.preventDefault()});B1(document.getElementById("app"),Z1());
